service cloud.firestore {
  match /databases/{database}/documents {
    match /teams/arts {
      allow read: if isAuthenticated();
    	match /accounts/{document} {
         allow read: if isAuthenticated()
                     && resource.data.permissions[(encodeEmail())] == true;
         allow write: if isAuthenticated()
                      && request.resource.data.permissions[(encodeEmail())] == true;
         allow delete: if isAuthenticated() 
         							 && resource.data.permissions[(encodeEmail())] == true;
      }
  	}
	}
}

function isAuthenticated() {
	return request.auth.token.email_verified == true && request.auth.token.email.matches('.*@asiarisktransfer[.]com');  
}

function encodeEmail() {
	return request.auth.token.email.split('[.]').join('%2E').split('[@]').join('%40');
}
